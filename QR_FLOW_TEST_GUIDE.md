# QR Flow Testing Guide

## üéØ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç QR –∫–æ–¥–∞ –∏ –≤–∏–∑–∏—Ç–æ–≤

–≠—Ç–æ—Ç –≥–∞–π–¥ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π flow –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR –∫–æ–¥–∞ –¥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∏–∑–∏—Ç–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏.

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **–ó–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
   ```bash
   docker-compose up -d
   # –∏–ª–∏
   ./start_project.sh
   ```

2. **–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - User App: http://localhost:3003
   - Merchant Dashboard: http://localhost:3001
   - Admin Dashboard: http://localhost:3000

---

## üß™ –®–∞–≥ –∑–∞ —à–∞–≥–æ–º: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ QR Flow

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ User App: http://localhost:3003
2. –ù–∞–∂–º–∏—Ç–µ "Get Started"
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å:
   - **Phone**: +998901234567
   - **Full Name**: Test User
   - **Email**: testuser@example.com
4. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

1. –í User App –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Subscriptions"
2. –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π –ø–ª–∞–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Basic Plan")
3. –ù–∞–∂–º–∏—Ç–µ "Subscribe"
4. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£ –≤–∞—Å —Ç–µ–ø–µ—Ä—å –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≤–∏–∑–∏—Ç–∞–º–∏

### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–∞

1. –í User App –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "My QR"
2. –ù–∞–∂–º–∏—Ç–µ "Generate QR Code"
3. **–í–∞–∂–Ω–æ:** –°–∫–æ–ø–∏—Ä—É–π—Ç–µ QR —Ç–æ–∫–µ–Ω (–æ–Ω –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ `YUVGO_xxxxx_xxxxx_xxxxx`)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- QR –∫–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Ç–∞–π–º–µ—Ä–æ–º –Ω–∞ 2 –º–∏–Ω—É—Ç—ã
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage:
  - `current_qr` - —Ç–µ–∫—É—â–∏–π QR –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `qr_YUVGO_xxxxx_xxxxx_xxxxx` - shared QR data –¥–ª—è Merchant Dashboard

### –®–∞–≥ 4: –í—Ö–æ–¥ –≤ Merchant Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ Merchant Dashboard: http://localhost:3001
2. –í–æ–π–¥–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—è:
   - **Phone**: +998901111111
   - **PIN**: 123456
   
   (–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ merchant —á–µ—Ä–µ–∑ Admin Dashboard)

### –®–∞–≥ 5: –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR –∫–æ–¥–∞

1. –í Merchant Dashboard –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "QR Scanner"
2. –í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π QR —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ
3. –ù–∞–∂–º–∏—Ç–µ "Process Check-in" –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Enter

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç QR —Ç–æ–∫–µ–Ω
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ shared storage
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤–∏–∑–∏—Ç–∞
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `merchant_visits` localStorage
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ `merchant_stats`

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–∑–∏—Ç–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏

1. –í Merchant Dashboard –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "Visit History"
2. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –Ω–æ–≤—ã–π –≤–∏–∑–∏—Ç —Å:
   - –î–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
   - –ò–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Test User)
   - –¢–µ–ª–µ—Ñ–æ–Ω–æ–º (+998901234567)
   - –°—Ç–∞—Ç—É—Å–æ–º (completed)

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫

### User App (http://localhost:3003)

- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- [ ] QR –∫–æ–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- [ ] –¢–∞–π–º–µ—Ä QR –∫–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (2 –º–∏–Ω—É—Ç—ã)
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –≤–∏–∑–∏—Ç–æ–≤

### Merchant Dashboard (http://localhost:3001)

- [ ] –í—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç (phone + PIN)
- [ ] QR Scanner –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –ú–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å/–≤–≤–µ—Å—Ç–∏ QR —Ç–æ–∫–µ–Ω
- [ ] –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
- [ ] –í–∏–∑–∏—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ Visit History
- [ ] –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω)
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ Dashboard

---

## üîç –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: QR –∫–æ–¥ –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞ (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `YUVGO_`)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ QR –∫–æ–¥ –Ω–µ –∏—Å—Ç–µ–∫ (2 –º–∏–Ω—É—Ç—ã)
3. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Application ‚Üí Local Storage
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–∞ `qr_YUVGO_...`

### –ü—Ä–æ–±–ª–µ–º–∞: –í–∏–∑–∏—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Application ‚Üí Local Storage
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `merchant_visits` - –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞—Å—Å–∏–≤ –≤–∏–∑–∏—Ç–æ–≤
3. –ù–∞–∂–º–∏—Ç–µ "Refresh" –≤ Visit History
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä –¥–∞—Ç—ã (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ "All Time")

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ QR –∫–æ–¥ –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –≤ User App
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ localStorage –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `qr_YUVGO_...` —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
3. –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å:
   - `user_id`
   - `user_name`
   - `user_phone`
   - `available_for_scan: true`

---

## üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ:

```javascript
// –û—Ç–∫—Ä–æ–π—Ç–µ DevTools Console –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

// –û—á–∏—Å—Ç–∏—Ç—å QR –∫–æ–¥—ã
localStorage.removeItem('current_qr');
Object.keys(localStorage).forEach(key => {
  if (key.startsWith('qr_YUVGO_')) {
    localStorage.removeItem(key);
  }
});

// –û—á–∏—Å—Ç–∏—Ç—å –≤–∏–∑–∏—Ç—ã
localStorage.removeItem('merchant_visits');
localStorage.removeItem('merchant_stats');

// –ò–ª–∏ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
localStorage.clear();
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### QR Data (User App)

```json
{
  "qr_token": "YUVGO_user123_1234567890_abc123",
  "user_id": "user123",
  "user_name": "Test User",
  "user_phone": "+998901234567",
  "user_email": "test@example.com",
  "subscription_id": "sub123",
  "visits_remaining": 5,
  "expires_in": 120,
  "generated_at": "2024-12-15T12:00:00.000Z",
  "available_for_scan": true
}
```

### Visit Record (Merchant Dashboard)

```json
{
  "id": "visit-1234567890",
  "qr_token": "YUVGO_user123_1234567890_abc123",
  "user_id": "user123",
  "user_name": "Test User",
  "user_phone": "+998901234567",
  "staff_id": "staff123",
  "staff_name": "Merchant Name",
  "check_in_time": "2024-12-15T12:00:00.000Z",
  "status": "completed",
  "notes": "Check-in via QR scan",
  "partner_id": "partner123",
  "created_at": "2024-12-15T12:00:00.000Z"
}
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (1 –º–∏–Ω—É—Ç–∞)

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ User App
open http://localhost:3003/qr

# 2. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ QR (–µ—Å–ª–∏ —É–∂–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã)
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ Merchant Dashboard
open http://localhost:3001/scanner

# 4. –í—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –Ω–∞–∂–º–∏—Ç–µ Enter

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å—Ç–æ—Ä–∏—é
open http://localhost:3001/visits
```

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **LocalStorage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback** - –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
2. **QR —Ç–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã** - —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **Cooldown –º–µ–∂–¥—É –≤–∏–∑–∏—Ç–∞–º–∏ - 4 —á–∞—Å–∞** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
4. **–í–∏–∑–∏—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage** - –º–∞–∫—Å–∏–º—É–º 100 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–∏–∑–∏—Ç–æ–≤

---

## ‚ú® –£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

1. ‚úÖ QR –∫–æ–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –≤ User App
2. ‚úÖ QR –∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –æ—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω –≤ Merchant Dashboard
3. ‚úÖ –í–∏–∑–∏—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Visit History —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ Dashboard
5. ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 15 –¥–µ–∫–∞–±—Ä—è 2024
**–í–µ—Ä—Å–∏—è:** 1.0.0
